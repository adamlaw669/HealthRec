{"version":3,"file":"AuthPage-L9Y2c3qH.js","sources":["../../app/components/GoogleLogin.tsx","../../app/features/auth/AuthPage.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { authAPI } from '../api/api';\n\nexport default function GoogleLoginComponent() {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (typeof window !== 'undefined' && window.google) {\n      const tokenClient = window.google.accounts.oauth2.initCodeClient({\n        client_id: '544730488651-rsgigbm1dfciek9q0d9pkt4mbr11s1tr.apps.googleusercontent.com',\n        scope: `\n          openid email profile\n          https://www.googleapis.com/auth/fitness.activity.read\n          https://www.googleapis.com/auth/fitness.heart_rate.read\n          https://www.googleapis.com/auth/fitness.sleep.read\n          https://www.googleapis.com/auth/fitness.body.read\n        `.replace(/\\s+/g, ' '),\n        ux_mode: 'popup',\n        callback: async (response: any) => {\n          if (response.code) {\n            try {\n              const result = await authAPI.googleCallback(response.code);\n              if (result.token && result.user) {\n                localStorage.setItem('token', result.token);\n                localStorage.setItem('user', JSON.stringify(result.user));\n                // Add a small delay to ensure storage is complete\n                setTimeout(() => {\n                  navigate('/dashboard');\n                }, 100);\n              } else {\n                console.error('Invalid response format:', result);\n                alert('Login failed: Invalid response from server');\n              }\n            } catch (error) {\n              console.error('Google callback error:', error);\n              alert('Login failed: ' + (error instanceof Error ? error.message : 'Unknown error'));\n            }\n          }\n        },\n      });\n\n      const loginBtn = document.getElementById('google-fit-btn');\n      if (loginBtn) {\n        loginBtn.addEventListener('click', () => {\n          tokenClient.requestCode();\n        });\n      }\n    }\n  }, [navigate]);\n\n  return (\n    <button\n      id=\"google-fit-btn\"\n      className=\"w-full py-2 px-4 bg-red-600 text-white rounded-md hover:bg-red-700\"\n    >\n      Continue with Google\n    </button>\n  );\n}","\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { Link, useNavigate, useSearchParams } from \"react-router-dom\"\nimport { authAPI } from \"../../api/api\"\nimport \"../../../assets/styles/auth-background.css\"\nimport GoogleLoginComponent from \"../../components/GoogleLogin\"\n//import APIConnectionTest from \"../../components/APIConnectionTest\"\n\nexport default function AuthPage() {\n  const navigate = useNavigate()\n  const [searchParams] = useSearchParams()\n  const [mode, setMode] = useState<'signin' | 'signup'>(searchParams.get('mode') === 'signup' ? 'signup' : 'signin')\n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n    confirmPassword: '',\n  })\n  const [error, setError] = useState<string | null>(null)\n  const [isLoading, setIsLoading] = useState(false)\n\n  useEffect(() => {\n    const user = localStorage.getItem(\"user\")\n    if (user) {\n      navigate(\"/dashboard\")\n    }\n  }, [navigate])\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    })\n    // Clear error when user starts typing\n    setError(null)\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setError(null)\n    setIsLoading(true)\n  \n    try {\n      if (mode === \"signup\") {\n        // Validate password length\n        if (formData.password.length < 8) {\n          throw new Error(\"Password must be at least 8 characters long\")\n        }\n        \n        // Validate password match\n        if (formData.password !== formData.confirmPassword) {\n          throw new Error(\"Passwords do not match\")\n        }\n        \n        // Validate email format\n        if (!formData.email.includes('@')) {\n          throw new Error(\"Please enter a valid email address\")\n        }\n  \n        const response = await authAPI.basic_signup(formData.email, formData.password)\n        if (response.user) {\n          localStorage.setItem(\"user\", JSON.stringify(response.user))\n          navigate(\"/dashboard\")\n        } else {\n          throw new Error(\"Signup failed. Please try again.\")\n        }\n      } else {\n        const response = await authAPI.login(formData.email, formData.password)\n        if (response.user) {\n          localStorage.setItem(\"user\", JSON.stringify(response.user))\n          navigate(\"/dashboard\")\n        } else {\n          throw new Error(\"Login failed. Please check your credentials.\")\n        }\n      }\n    } catch (err: any) {\n      console.error(\"Error:\", err)\n      setError(err.message || \"Something went wrong\")\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex flex-col items-center justify-center auth-background\">\n      <div className=\"bg-gray-900/40 backdrop-blur-sm p-8 rounded-lg shadow-xl w-full max-w-md border border-white/10 auth-form-container mb-4\">\n        {/* Centered Logo */}\n        <div className=\"flex flex-col items-center justify-center mb-8\">\n          <Link to=\"/\" className=\"flex flex-col items-center\">\n            <img \n              src=\"/healthreclogo.png\" \n              alt=\"HealthRec Engine Logo\" \n              className=\"w-20 h-20\"\n            />\n          </Link>\n        </div>\n\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold text-white mb-4\">\n            Welcome to HealthRec Engine\n          </h1>\n          <p className=\"text-gray-300\">\n            {mode === 'signup' ? 'Create an account to get started' : 'Sign in to your account'}\n          </p>\n        </div>\n\n        {/* Error Message */}\n        {error && (\n          <div className=\"mb-4 p-4 bg-red-500/10 border border-red-500/20 rounded-lg\">\n            <p className=\"text-red-400 text-sm\">{error}</p>\n          </div>\n        )}\n\n        {/* Email/Password Form */}\n        <form onSubmit={handleSubmit} className=\"space-y-4 mb-6\" noValidate>\n          <div>\n            <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-300\">\n              Email\n            </label>\n            <input\n              type=\"email\"\n              id=\"email\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleInputChange}\n              required\n              className=\"mt-1 block w-full px-3 py-2 bg-gray-800/50 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Enter your email\"\n            />\n          </div>\n          <div>\n            <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-300\">\n              Password\n            </label>\n            <input\n              type=\"password\"\n              id=\"password\"\n              name=\"password\"\n              value={formData.password}\n              onChange={handleInputChange}\n              required\n              className=\"mt-1 block w-full px-3 py-2 bg-gray-800/50 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Enter your password\"\n            />\n          </div>\n          {mode === 'signup' && (\n            <div>\n              <label htmlFor=\"confirmPassword\" className=\"block text-sm font-medium text-gray-300\">\n                Confirm Password\n              </label>\n              <input\n                type=\"password\"\n                id=\"confirmPassword\"\n                name=\"confirmPassword\"\n                value={formData.confirmPassword}\n                onChange={handleInputChange}\n                required\n                className=\"mt-1 block w-full px-3 py-2 bg-gray-800/50 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"Confirm your password\"\n              />\n            </div>\n          )}\n          <button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 transition-colors\"\n          >\n            {isLoading ? 'Processing...' : mode === 'signup' ? 'Create Account' : 'Sign In'}\n          </button>\n        </form>\n\n        <div className=\"relative mb-6\">\n          <div className=\"absolute inset-0 flex items-center\">\n            <div className=\"w-full border-t border-gray-600\"></div>\n          </div>\n          <div className=\"relative flex justify-center text-sm\">\n            <span className=\"px-2 bg-gray-900/40 text-gray-400\">Or continue with</span>\n          </div>\n        </div>\n\n        {/* Google Login Button */}\n        <div className=\"mb-6\">\n          <GoogleLoginComponent />\n        </div>\n\n        {/* Toggle Sign In/Sign Up */}\n        <p className=\"text-center text-sm text-gray-400\">\n          {mode === 'signin' ? (\n            <>\n              Don't have an account?{' '}\n              <button\n                onClick={() => setMode('signup')}\n                className=\"text-blue-500 hover:underline focus:outline-none\"\n              >\n                Sign up\n              </button>\n            </>\n          ) : (\n            <>\n              Already have an account?{' '}\n              <button\n                onClick={() => setMode('signin')}\n                className=\"text-blue-500 hover:underline focus:outline-none\"\n              >\n                Sign in\n              </button>\n            </>\n          )}\n        </p>\n\n        {/* Privacy Notice */}\n        <p className=\"mt-6 text-center text-sm text-gray-400\">\n          By continuing, you agree to our{\" \"}\n          <Link to=\"/privacy\" className=\"text-blue-500 hover:underline\">\n            Privacy Policy\n          </Link>{\" \"}\n          and{\" \"}\n          <Link to=\"/terms\" className=\"text-blue-500 hover:underline\">\n            Terms of Service\n          </Link>\n        </p>\n      </div>\n    </div>\n  )\n}"],"names":["GoogleLoginComponent","navigate","useNavigate","useEffect","tokenClient","response","result","authAPI","error","loginBtn","jsx","AuthPage","searchParams","useSearchParams","mode","setMode","useState","formData","setFormData","setError","isLoading","setIsLoading","handleInputChange","e","handleSubmit","err","jsxs","Link","Fragment"],"mappings":"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"}