import{u as p,b as a,d as m,j as e,e as w,L as u}from"./index-TQdBg8Zg.js";function y(){const o=p();return a.useEffect(()=>{if(typeof window<"u"&&window.google){const i=window.google.accounts.oauth2.initCodeClient({client_id:"544730488651-rsgigbm1dfciek9q0d9pkt4mbr11s1tr.apps.googleusercontent.com",scope:`
          openid email profile
          https://www.googleapis.com/auth/fitness.activity.read
          https://www.googleapis.com/auth/fitness.heart_rate.read
          https://www.googleapis.com/auth/fitness.sleep.read
          https://www.googleapis.com/auth/fitness.body.read
        `.replace(/\s+/g," "),ux_mode:"popup",callback:async n=>{if(n.code)try{const s=await m.googleCallback(n.code);s.token&&s.user?(localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(s.user)),setTimeout(()=>{o("/dashboard")},100)):(console.error("Invalid response format:",s),alert("Login failed: Invalid response from server"))}catch(s){console.error("Google callback error:",s),alert("Login failed: "+(s instanceof Error?s.message:"Unknown error"))}}}),r=document.getElementById("google-fit-btn");r&&r.addEventListener("click",()=>{i.requestCode()})}},[o]),e.jsx("button",{id:"google-fit-btn",className:"w-full py-2 px-4 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Continue with Google"})}function v(){const o=p(),[i]=w(),[r,n]=a.useState(i.get("mode")==="signup"?"signup":"signin"),[s,x]=a.useState({email:"",password:"",confirmPassword:""}),[g,c]=a.useState(null),[h,f]=a.useState(!1);a.useEffect(()=>{localStorage.getItem("user")&&o("/dashboard")},[o]);const d=l=>{x({...s,[l.target.name]:l.target.value}),c(null)},b=async l=>{l.preventDefault(),c(null),f(!0);try{if(r==="signup"){if(s.password.length<8)throw new Error("Password must be at least 8 characters long");if(s.password!==s.confirmPassword)throw new Error("Passwords do not match");if(!s.email.includes("@"))throw new Error("Please enter a valid email address");const t=await m.basic_signup(s.email,s.password);if(t.user)localStorage.setItem("user",JSON.stringify(t.user)),o("/dashboard");else throw new Error("Signup failed. Please try again.")}else{const t=await m.login(s.email,s.password);if(t.user)localStorage.setItem("user",JSON.stringify(t.user)),o("/dashboard");else throw new Error("Login failed. Please check your credentials.")}}catch(t){console.error("Error:",t),c(t.message||"Something went wrong")}finally{f(!1)}};return e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center auth-background",children:e.jsxs("div",{className:"bg-gray-900/40 backdrop-blur-sm p-8 rounded-lg shadow-xl w-full max-w-md border border-white/10 auth-form-container mb-4",children:[e.jsx("div",{className:"flex flex-col items-center justify-center mb-8",children:e.jsx(u,{to:"/",className:"flex flex-col items-center",children:e.jsx("img",{src:"/healthreclogo.png",alt:"HealthRec Engine Logo",className:"w-20 h-20"})})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"Welcome to HealthRec Engine"}),e.jsx("p",{className:"text-gray-300",children:r==="signup"?"Create an account to get started":"Sign in to your account"})]}),g&&e.jsx("div",{className:"mb-4 p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsx("p",{className:"text-red-400 text-sm",children:g})}),e.jsxs("form",{onSubmit:b,className:"space-y-4 mb-6",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:d,required:!0,className:"mt-1 block w-full px-3 py-2 bg-gray-800/50 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your email"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300",children:"Password"}),e.jsx("input",{type:"password",id:"password",name:"password",value:s.password,onChange:d,required:!0,className:"mt-1 block w-full px-3 py-2 bg-gray-800/50 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your password"})]}),r==="signup"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300",children:"Confirm Password"}),e.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:s.confirmPassword,onChange:d,required:!0,className:"mt-1 block w-full px-3 py-2 bg-gray-800/50 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirm your password"})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 transition-colors",children:h?"Processing...":r==="signup"?"Create Account":"Sign In"})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-600"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-gray-900/40 text-gray-400",children:"Or continue with"})})]}),e.jsx("div",{className:"mb-6",children:e.jsx(y,{})}),e.jsx("p",{className:"text-center text-sm text-gray-400",children:r==="signin"?e.jsxs(e.Fragment,{children:["Don't have an account?"," ",e.jsx("button",{onClick:()=>n("signup"),className:"text-blue-500 hover:underline focus:outline-none",children:"Sign up"})]}):e.jsxs(e.Fragment,{children:["Already have an account?"," ",e.jsx("button",{onClick:()=>n("signin"),className:"text-blue-500 hover:underline focus:outline-none",children:"Sign in"})]})}),e.jsxs("p",{className:"mt-6 text-center text-sm text-gray-400",children:["By continuing, you agree to our"," ",e.jsx(u,{to:"/privacy",className:"text-blue-500 hover:underline",children:"Privacy Policy"})," ","and"," ",e.jsx(u,{to:"/terms",className:"text-blue-500 hover:underline",children:"Terms of Service"})]})]})})}export{v as default};
//# sourceMappingURL=AuthPage-L9Y2c3qH.js.map
